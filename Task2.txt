-- create products
CREATE TABLE PRODUCT (
  prodId INTEGER PRIMARY KEY,
  name TEXT NOT NULL
);

INSERT INTO PRODUCT VALUES (0001, 'product1');
INSERT INTO PRODUCT VALUES (0002, 'product2');
INSERT INTO PRODUCT VALUES (0003, 'product3');
INSERT INTO PRODUCT VALUES (0004, 'product4');
INSERT INTO PRODUCT VALUES (0005, 'product5');
INSERT INTO PRODUCT VALUES (0006, 'product6');

-- create categories
CREATE TABLE CATEGORY (
  ctgId INTEGER PRIMARY KEY,
  name TEXT NOT NULL
);

INSERT INTO CATEGORY VALUES (0001, 'category1');
INSERT INTO CATEGORY VALUES (0002, 'category2');
INSERT INTO CATEGORY VALUES (0003, 'category3');
INSERT INTO CATEGORY VALUES (0004, 'category4');
INSERT INTO CATEGORY VALUES (0005, 'category5');
-- insert

-- create pairs
CREATE TABLE LIST (
  prodId INTEGER,
  ctgId INTEGER
);

INSERT INTO LIST VALUES (0001, 0001);
INSERT INTO LIST VALUES (0002, 0001);
INSERT INTO LIST VALUES (0002, 0002);
INSERT INTO LIST VALUES (0002, 0003);
INSERT INTO LIST VALUES (0002, 0004);
INSERT INTO LIST VALUES (0003, 0003);
INSERT INTO LIST VALUES (0004, 0002);
INSERT INTO LIST VALUES (0004, 0003);
INSERT INTO LIST VALUES (0004, 0004);
INSERT INTO LIST VALUES (0005, 0001);
INSERT INTO LIST VALUES (0005, 0005);

-- create list of all products and categories
SELECT 
  P.name as productName,
  C.name as categoryName
FROM PRODUCT P
left join (LIST L 
            join CATEGORY C on L.ctgId = C.ctgId) on P.prodId = L.prodId